<!DOCTYPE html>
<html>
<head>
    <title>Disease & Weather Portal</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<h1>Disease & Weather Portal</h1>

<!-- Auto or Manual Location -->
<p><b>Allow browser to detect your location or enter manually:</b></p>
<button onclick="getLocation()">Use My Location</button>
<input type="text" id="manualLocation" placeholder="Enter city or place">
<button onclick="manualLocation()">Use Manual Location</button>

<div id="info" style="margin-top:20px;background:#f0f0f0;padding:10px;"></div>

<a href="/map" target="_blank">View Map of Risk Zones</a>

<hr>
<h2>Ask Our AI Bot</h2>
<textarea id="botInput" rows="3" cols="60" placeholder="Ask anything about health, weather, or safety..."></textarea><br>
<button onclick="sendToBot()">Ask</button>
<p><strong>Bot says:</strong></p>
<div id="botReply" style="white-space: pre-wrap; background:#f0f0f0; padding:10px;"></div>

<script>
// --- Automatic Location ---
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position){
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      sendData(lat, lon);
    });
  } else {
    document.getElementById('info').innerText = "Geolocation is not supported by this browser.";
  }
}

// --- Manual Location using OpenCage or Nominatim ---
async function manualLocation() {
  const place = document.getElementById('manualLocation').value;
  if (!place) return alert('Enter a place');
  const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(place)}`);
  const data = await res.json();
  if (data.length > 0) {
    const lat = data[0].lat;
    const lon = data[0].lon;
    sendData(lat, lon);
  } else {
    alert('Location not found');
  }
}

// --- Send lat/lon to server ---
async function sendData(lat, lon) {
  document.getElementById('info').innerText = "Loading data...";
  const response = await fetch('/data', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({lat: lat, lo
